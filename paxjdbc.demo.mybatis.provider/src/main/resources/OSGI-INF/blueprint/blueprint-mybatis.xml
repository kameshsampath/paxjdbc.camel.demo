<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd">

		<reference id="demodbDS" interface="javax.sql.DataSource" filter="(dataSourceName=demodbDS)"/>

		<!-- Transaction factory to use-->
		<bean id="transactionFactory" class="org.apache.ibatis.transaction.jdbc.JdbcTransactionFactory"/>

		<!-- MyBatis environment -->
		<bean id="environment" class="org.apache.ibatis.mapping.Environment">
				<argument value="development"/>
				<argument ref="transactionFactory"/>
				<argument ref="demodbDS"/>
		</bean>

		<!-- Configuration -->

		<bean id="configuration" class="org.apache.ibatis.session.Configuration">
				<argument ref="environment"/>
		</bean>

		<!-- Factory class to build SqlSessionFactory -->

		<bean id="sqlSessionFactoryBuilder" class="org.apache.ibatis.session.SqlSessionFactoryBuilder"/>

		<!-- Build SQL Session Factory -->
		<bean id="sqlSessionFactory" class="org.apache.ibatis.session.SqlSessionFactory"
		      factory-ref="sqlSessionFactoryBuilder" factory-method="build">
				<argument ref="configuration"/>
		</bean>

		<service id="svcSqlSessionFactory" interface="org.apache.ibatis.session.SqlSessionFactory" ref="sqlSessionFactory">
				<service-properties>
						<entry key="environment" value="development"/>
						<entry key="sourceDS" value="demodbDS"/>
				</service-properties>
		</service>

</blueprint>
